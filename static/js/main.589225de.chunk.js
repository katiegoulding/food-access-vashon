(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{365:function(e,t,a){e.exports=a.p+"static/media/farmBuckEnglish.80ad82af.jpg"},366:function(e,t,a){e.exports=a.p+"static/media/farmBuckSpanish.1ad6f708.jpg"},392:function(e,t,a){e.exports=a(662)},397:function(e,t,a){},398:function(e,t,a){},662:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(118),l=a.n(r),s=(a(397),a(25)),i=a(23),c=a(31),u=a(29),m=a(30),d=(a(398),a(691)),h=a(693),p=a(694),f={routes:{barrier:"/barrier",createAccount:"/signup",accountRecovery:"/recover",base:"/",dash:{base:"/dash",viewData:"/dash/ViewData",createBucks:"/dash/CreateBucks",bucksLanding:"/dash/BucksLanding",viewBucks:"/dash/ViewBucks",scan:"/dash/Scan",manageAccount:"/dash/manage",editAccount:"/dash/manage/edit",formSuccess:"/dash/formSuccess",farmerPayout:"/dash/farmerPayout"}},variables:{colors:{bodyBG:"#EFF0F3"}}},v=(a(56),a(57),a(675)),g=a(18),b=a.n(g),E=a(672),y=a(689),C=a(684),k=a(681),S=a(382),w=a(674),O=a(108),x=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOnUpdate=function(e,t){var n=t.width;return a.setState({width:n})},a.state={email:"",pw:"",role:"",errorMessage:void 0,loading:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){t&&t.getIdTokenResult().then(function(t){console.log(t.claims.role),t.claims.role?e.props.history.push(f.routes.dash.base):e.props.history.push(f.routes.barrier)})})}},{key:"componentWillUnmount",value:function(){this.authUnsub()}},{key:"handleSignIn",value:function(e){var t=this;e.preventDefault(),this.setState({loading:!0}),b.a.auth().signInWithEmailAndPassword(this.state.email,this.state.pw).catch(function(e){return t.setState({errorMessage:e.message,loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.errorMessage,r=this.state.width>=E.a.onlyTablet.minWidth?"6":"12";return o.a.createElement(E.a,{as:y.a,fireOnMount:!0,onUpdate:this.handleOnUpdate,centered:"true",middle:!0,columns:1},o.a.createElement(y.a.Column,{width:r,verticalAlign:"middle",textAlign:"left"},o.a.createElement(C.a,{attached:"top",header:"Welcome to our site!",content:"Sign in to access your account",className:"messageHeader loginIllustrations"}),o.a.createElement(k.a,{className:"attached fluid segment messageBody",onSubmit:function(t){return e.handleSignIn(t)},error:n,loading:a},o.a.createElement(C.a,{error:!0,header:n,content:"not logged in"}),o.a.createElement(k.a.Input,{required:!0,id:"email",label:"Email",placeholder:"Email",type:"email",value:this.state.email,onInput:function(t){return e.setState({email:t.target.value})},className:"LogInActivity-Input-Style"}),o.a.createElement(k.a.Input,{required:!0,id:"pw",label:"Password",placeholder:"Password",type:"password",value:this.state.pw,onInput:function(t){return e.setState({pw:t.target.value})},className:"LogInActivity-Input-Style"}),o.a.createElement(S.a,{type:"submit"},"Sign In"),o.a.createElement(w.a,{hidden:!0}),o.a.createElement(v.a,{to:f.routes.accountRecovery},"Forgot password?")),o.a.createElement(C.a,{attached:"bottom",className:"messageFooter",info:!0},o.a.createElement(O.a,{name:"help"}),"Don't have an account? \xa0",o.a.createElement(v.a,{to:f.routes.createAccount},"Sign Up"),"\xa0instead.")))}}]),t}(o.a.Component),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOnUpdate=function(e,t){var n=t.width;return a.setState({width:n})},a.state={firstName:"",lastName:"",role:"",org:"",email:"",pw:"",pw_confirm:"",errorMessage:void 0},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){t&&t.getIdTokenResult().then(function(t){console.log(t.claims.role),t.claims.role?e.props.history.push(f.routes.dash.base):e.props.history.push(f.routes.barrier)})})}},{key:"handleCreateAccount",value:function(e){var t=this;if(e.preventDefault(),this.setState({loading:!0}),"admin"!==this.state.role.toLowerCase()&&"bookkeeper"!==this.state.role.toLowerCase()||this.setState({org:"fap"}),this.state.pw!==this.state.pw_confirm)this.setState({errorMessage:"Passwords do not match",loading:!1});else{if(""===this.state.displayName)return void this.setState({errorMessage:"Enter Display Name",loading:!1});if(this.state.pw.length<6)return void this.setState({errorMessage:"Password must be at least six characters",loading:!1});b.a.auth().createUserWithEmailAndPassword(this.state.email,this.state.pw).then(function(e){try{return t.setState({loading:!0,errorMessage:""}),console.log("response = ",e),b.a.database().ref("/users/".concat(e.user.uid)).set({firstName:t.state.firstName,lastName:t.state.lastName,email:t.state.email,role:t.state.role,lastPayoutDate:"N/A",org:t.state.org,vouchersList:[],approved:!1})}catch(a){return console.log("err on write to db = ",a),t.setState({loading:!1,errorMessage:a.message})}}).catch(function(e){console.log("err on write to db = ",e),t.setState({loading:!1,errorMessage:e.message})})}}},{key:"render",value:function(){var e=this,t=[{key:"f",text:"Vashon Community Food Bank",value:"foodbank"},{key:"d",text:"The Dove Project",value:"dove"},{key:"c",text:"Vashon Community Care",value:"vcc"},{key:"s",text:"Vashon Senior Center",value:"seniorcenter"},{key:"i",text:"Interfaith Council to Prevent Homelessness",value:"interfaith"},{key:"m",text:"Community Meals",value:"communitymeals"},{key:"h",text:"Vashon Household",value:"vashonhousehold"},{key:"l",text:"La Comunidad & ECEAP",value:"lacomunidad"},{key:"y",text:"VYFS",value:"vyfs"},{key:"x",text:"VYFS: Latinx",value:"vyfslatinx"},{key:"p",text:"VYFS: Family Place",value:"vyfsfamily"}],a=this.state,n=a.loading,r=a.errorMessage,l=a.role,s=this.state.width>=E.a.onlyTablet.minWidth?"6":"12";return o.a.createElement(E.a,{as:y.a,fireOnMount:!0,onUpdate:this.handleOnUpdate,centered:"true",middle:!0,columns:1},o.a.createElement(y.a.Column,{width:s,verticalAlign:"middle",textAlign:"left",className:"mt100 mb100"},o.a.createElement(C.a,{attached:!0,header:"Create an Account",content:"Provide some basic information to get started!",className:"messageHeader loginIllustrations"}),o.a.createElement(k.a,{className:"attached fluid segment messageBody",onSubmit:function(t){return e.handleCreateAccount(t)},error:r,loading:n},o.a.createElement(C.a,{error:!0,header:"Account not created",content:r}),o.a.createElement(k.a.Input,{required:!0,label:"First Name",htmlFor:"firstName",id:"firstName",type:"text",className:"form-control",value:this.state.firstName,onInput:function(t){return e.setState({firstName:t.target.value})}}),o.a.createElement(k.a.Input,{required:!0,label:"Last Name",htmlFor:"lastName",id:"lastName",type:"text",className:"form-control",value:this.state.lastName,onInput:function(t){return e.setState({lastName:t.target.value})}}),o.a.createElement(k.a.Select,{required:!0,label:"Role",htmlFor:"role",value:this.state.role,options:[{key:"f",text:"Farmer",value:"Farmer"},{key:"c",text:"Caseworker",value:"Caseworker"},{key:"a",text:"Admin",value:"Admin"},{key:"b",text:"Bookkeeper",value:"Bookkeeper"}],onChange:function(t,a){e.setState({role:a.value})}}),function(){switch(l){case"Caseworker":return o.a.createElement(k.a.Select,{required:!0,label:"Affiliated Organization:",htmlFor:"organization",value:e.state.org,options:t,onChange:function(t,a){e.setState({org:a.value})}});case"Farmer":return o.a.createElement(k.a.Input,{required:!0,label:"Farm Name:",htmlFor:"organization",value:e.state.org,onInput:function(t){return e.setState({org:t.target.value})}});case"Admin":case"Bookkeeper":return o.a.createElement(k.a.Input,{label:"Affiliated Organization:",htmlFor:"organization",value:"Food Access Partnership",placeholder:"Food Access Partnership",readOnly:!0});default:return o.a.createElement("div",null)}}(),o.a.createElement(k.a.Input,{required:!0,id:"email",htmlFor:"email",label:"Email",type:"email",placeholder:"Enter your email address",value:this.state.email,onInput:function(t){return e.setState({email:t.target.value})}}),o.a.createElement(k.a.Input,{required:!0,id:"pw",htmlFor:"password",label:"Password",type:"password",placeholder:"Enter your password",value:this.state.pw,onInput:function(t){return e.setState({pw:t.target.value})}}),o.a.createElement(k.a.Input,{required:!0,id:"pw_confrim",htmlFor:"passwordConfirm",label:"Reenter Password",type:"password",placeholder:"confirm your password",value:this.state.pw_confirm,onInput:function(t){return e.setState({pw_confirm:t.target.value})}}),o.a.createElement(S.a,{type:"submit"},"Create Account")),o.a.createElement(C.a,{attached:"bottom",className:"messageFooter",info:!0},o.a.createElement(O.a,{name:"help"}),"Already have an account? \xa0",o.a.createElement(v.a,{to:f.routes.base},"Sign in!"),"\xa0")))}}]),t}(o.a.Component),D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOnUpdate=function(e,t){var n=t.width;return a.setState({width:n})},a.state={email:"",errorMessage:!1,successMessage:void 0},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){e.setState({currentUser:t})})}},{key:"componentWillUnmount",value:function(){this.authUnsub()}},{key:"handlePasswordReset",value:function(e){var t=this,a=b.a.auth();this.setState({errorMessage:void 0}),a.sendPasswordResetEmail(this.state.email).then(this.setState({successMessage:!0,email:""})).catch(function(e){return t.setState({errorMessage:e.message})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.width,n=t.successMessage,r=(t.email,a>=E.a.onlyTablet.minWidth?"6":"12");return o.a.createElement(E.a,{as:y.a,fireOnMount:!0,onUpdate:this.handleOnUpdate,centered:"true",middle:!0,columns:1},o.a.createElement(y.a.Column,{width:r,verticalAlign:"middle",textAlign:"left"},o.a.createElement(C.a,{attached:"top",header:"Account Recovery",content:"Enter your account email to reset your password.",className:"messageHeader"}),o.a.createElement(k.a,{className:"attached fluid segment messageBody",onSubmit:function(t){return e.handlePasswordReset(t)},warning:n},o.a.createElement(k.a.Input,{required:!0,id:"email",label:"Email",type:"email",placeholder:"Enter your email address",value:this.state.email,onInput:function(t){return e.setState({email:t.target.value})}}),o.a.createElement(S.a,{type:"submit",content:"Reset"}),o.a.createElement(C.a,{warning:!0,header:"Thank you",content:"If that account exists in our system, password reset steps will be sent"}))))}}]),t}(o.a.Component),A=a(73),B=a(683),P=a(197),I=a(676),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).showView=function(){return a.setState({viewModalOpen:!0})},a.open=function(){return a.setState({open:!0})},a.close=function(){return a.setState({open:!1})},a.deleteBuckSet=function(){var e=a.props.data.name;if(console.log("buck set title ",a.props.data.name),e&&""!==e){var t=b.a.database().ref("buckSets/"+e);console.log("buckSetRef ",t),t.remove().then(function(){console.log("Remove succeeded."),a.setState({deleteModalOpen:!1})}).catch(function(e){console.log("Remove failed: "+e.message)})}var n=["-LgUwC00_cfHr7ATng36","-LgUwC073TuLVb7GEwbd","-LgUwC03B1lvd96j4SEk","-LgUwC02CEocI6-oh70K","-LgUwC01fmb5evqJck9r","-LgUwC062cOmWzEKuVCb","-LgUwC08c93TaO2LbaIC","-LgUwC05_kbA62CmoJpL","-LgUwC08c93TaO2LbaIB","-LgUwC04hqV_WdBArGnR","-LgUwC073TuLVb7GEwbe","-LgUwC03B1lvd96j4SEl"];b.a.database().ref("vouchers/").once("value",function(t){var a=0;t.forEach(function(t){t.buckSet===e&&n.includes(t.key)&&a++}),console.log("deleteCount",a)}),a.close()},a.viewBuckSet=function(){},a.state={viewModalOpen:!1,deleteModalOpen:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,a=t.name,n=t.createdBy,r=(t.data,t.createdOn),l=t.expirationDate,s=t.communitycareCount,i=t.communitymealsCount,c=t.doveCount,u=t.foodbankCount,m=t.interfaithCount,d=t.lacomunidadCount,h=t.seniorcenterCount,p=t.vashonhouseholdCount,f=t.vyfsCount,v=t.vyfsfamilyplaceCount,g=t.vyfslatinxCount,b=(this.state.open,new Date(r)),E=b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear();return o.a.createElement(B.a,{fluid:!0},o.a.createElement(B.a.Content,null,o.a.createElement(B.a.Header,null,a),o.a.createElement(B.a.Meta,null,n)),o.a.createElement(B.a.Content,{extra:!0},o.a.createElement(P.a,{trigger:o.a.createElement(S.a,{primary:!0,content:"View"}),size:"small",open:this.viewModalOpen,onClose:this.close,closeIcon:!0},o.a.createElement(P.a.Header,null,'"',a,'" Buck Set'),o.a.createElement(P.a.Content,null,o.a.createElement("p",null,o.a.createElement("b",null,"Created by")," ",n),o.a.createElement("p",null,o.a.createElement("b",null,"Created on")," ",E),o.a.createElement("p",null,o.a.createElement("b",null,"Expires")," ",l),o.a.createElement("h4",null,"Counts"),o.a.createElement("p",null,"Community Care: ",s),o.a.createElement("p",null,"Community Meals: ",i),o.a.createElement("p",null,"DOVE: ",c),o.a.createElement("p",null,"Food Bank: ",u),o.a.createElement("p",null,"Interfaith Council: ",m),o.a.createElement("p",null,"La Comunidad: ",d),o.a.createElement("p",null,"Senior Center: ",h),o.a.createElement("p",null,"Vashon Household: ",p),o.a.createElement("p",null,"VYFS: ",f),o.a.createElement("p",null,"VYFS Family Place: ",v),o.a.createElement("p",null,"VYFS Latinx Count: ",g))),o.a.createElement(S.a,{icon:"trash",onClick:this.open}),o.a.createElement(I.a,{size:"small",header:"Are you sure you want to delete ".concat(a," Buck Set?"),content:"Doing so will mark all VIGA bucks generated for this set as inactive",cancelButton:"Cancel",confirmButton:"Delete",open:this.state.open,onCancel:this.close,onConfirm:function(){return e.deleteBuckSet()}})))}}]),t}(o.a.Component),L=a(677),T=a(690),V=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={firebaseBuckSet:[]},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=[],a=b.a.database().ref("buckSets");a.orderByChild("createdOn").on("child_added",function(a){var n=a.val();t.push({name:n.name,createdBy:n.createdBy,createdOn:n.createdOn,expirationDate:n.expirationDate,communitycareCount:n.communitycareCount,communitymealsCount:n.communitymealsCount,doveCount:n.doveCount,foodbankCount:n.foodbankCount,interfaithCount:n.interfaithCount,lacomunidadCount:n.lacomunidadCount,seniorcenterCount:n.seniorcenterCount,vashonhouseholdCount:n.vashonhouseholdCount,vyfsCount:n.vyfsCount,vyfsfamilyplaceCount:n.vyfsfamilyplaceCount,vyfslatinxCount:n.vyfslatinxCount}),e.setState({firebaseBuckSet:t})}),console.log("in componnent did mount in ViewBucks"),a.orderByChild("createdOn").on("child_removed",function(a){var n=a.val();t=t.filter(function(e){return!(e.title===n.name&&e.subtitle===n.createdBy)}),e.setState({firebaseBuckSet:t})})}},{key:"render",value:function(){return o.a.createElement(y.a.Column,{width:6},o.a.createElement(L.a,null,o.a.createElement(T.a,{as:"h2"},"Existing Buck Sets"),o.a.createElement(B.a.Group,null,this.state.firebaseBuckSet.map(function(e){return o.a.createElement(N,{key:e.name+e.createdBy+e.createdOn+e.expirationDate+e.communitycareCount+e.communitymealsCount+e.doveCount+e.foodbankCount+e.interfaithCount+e.lacomunidadCount+e.seniorcenterCount+e.vashonhouseholdCount+e.vyfsCount+e.vyfsfamilyplaceCount+e.vyfslatinxCount,data:e})}))))}}]),t}(o.a.Component),F=a(34),M=a.n(F),U=a(122),R=(a(337),a(678)),z=a(687),H=a(138),W=a.n(H),Z=a(191),Y=a.n(Z);W.a.vfs=Y.a.pdfMake.vfs;var _=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).validateFormData=function(){var e=Object(U.a)(M.a.mark(function e(t){var n,o,r;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<=0)){e.next=3;break}return a.setState({errorMessage:"Sum of vouchers in form must be greater than zero."}),e.abrupt("return",!1);case 3:return n=a.props.buckSetName,o=b.a.database().ref("buckSets"),r=!1,e.next=8,o.orderByChild("name").equalTo(n).once("value",function(e){e.forEach(function(e){e.key;e.val().name==n&&(a.setState({errorMessage:"The buck set name you used already exists."}),r=!0)})});case 8:r||a.props.toggleShowCreateBucks();case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={loading:!1,complete:!1,hasError:!1,errorMessage:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.errorMessage,r=this.props.foodbankCount+this.props.doveCount+this.props.communitycareCount+this.props.seniorcenterCount+this.props.interfaithCount+this.props.communitymealsCount+this.props.vashonhouseholdCount+this.props.lacomunidadCount+this.props.vyfsCount+this.props.vyfslatinxCount+this.props.vyfsfamilyplaceCount;return o.a.createElement(y.a.Column,{width:10},o.a.createElement(R.a,{className:"master_modal_container"},o.a.createElement(L.a,{className:"modal_container"},o.a.createElement(k.a,{onSubmit:this.validateFormData,loading:a,error:n},o.a.createElement(k.a.Input,{inline:!0,required:!0,fluid:!0,transparent:!0,size:"massive",placeholder:"Buck Set Name",value:this.props.buckSetName,onInput:function(t){return e.props.handleChange({buckSetName:t.target.value})},className:"buck_set_name_input"}),o.a.createElement(k.a.Input,{width:9,inline:!0,required:!0,fluid:!0,label:"Expiration Date",type:"date",className:"expiration_date_container",value:this.props.expirationDate,onInput:function(t){return e.props.handleChange({expirationDate:t.target.value})}}),o.a.createElement(T.a,{as:"h5",color:"grey",textAlign:"left"},"BUCK ALLOCATION"),o.a.createElement(z.a.Group,{widths:"two",className:"statistics_big_numbers"},o.a.createElement(z.a,null,o.a.createElement(z.a.Value,{className:"statistic_number"},1*r),o.a.createElement(z.a.Label,null,"VIGA Bucks")),o.a.createElement(z.a,null,o.a.createElement(z.a.Value,{className:"statistic_number"},"$",2*r,".00"),o.a.createElement(z.a.Label,null,"Dollars"))),o.a.createElement(w.a,{hidden:!0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Vashon Community Food Bank",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({foodbankCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"DoVE",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({doveCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Vashon Community Care",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({communitycareCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Vashon Senior Center",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({seniorcenterCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Interfaith Council to Prevent Homelessness",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({interfaithCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Community Meals",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({communitymealsCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"Vashon Household",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({vashonhouseholdCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"La Communidad \\ ECEAP",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({lacomunidadCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"VYFS",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({vyfsCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"VYFS: Latinx",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({vyfslatinxCount:Number(t.target.value)})},min:0}),o.a.createElement(k.a.Input,{width:16,inline:!0,size:"mini",fluid:!0,label:"VYFS: Family Place",placeholder:0,type:"number",onInput:function(t){return e.props.handleChange({vyfsfamilyplaceCount:Number(t.target.value)})},min:0}),o.a.createElement(w.a,{hidden:!0}),o.a.createElement(S.a,{color:"blue"},"Next Step"),o.a.createElement(C.a,{error:!0,header:n,content:"form not submitted"})))))}}]),t}(o.a.Component),$=a(43),q=a(679),G=a(365),K=a.n(G),Q=a(366),J=a.n(Q);W.a.vfs=Y.a.pdfMake.vfs;var X={foodbank:"A-1",dove:"A-2",vcc:"A-3",seniorcenter:"A-4",interfaith:"A-5",communitymeals:"A-6",vashonhousehold:"A-7",lacomunidad:"A-8",vyfs:"A-9",vyfslatinx:"A-10",vyfsfamily:"A-11"},ee=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toDataURL=function(e,t,a){var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var e,n=document.createElement("CANVAS"),o=n.getContext("2d");n.height=this.naturalHeight,n.width=this.naturalWidth,o.drawImage(this,0,0),e=n.toDataURL(a),t(e)},n.src=e,(n.complete||void 0===n.complete)&&(n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",n.src=e)},a.handleSubmit=function(){var e=Object(U.a)(M.a.mark(function e(t){var n,o,r,l,s,i,c,u,m,d,h,p,f,v,g;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=a.props,o=n.foodbankCount,r=n.doveCount,l=n.communitycareCount,s=n.seniorcenterCount,i=n.interfaithCount,c=n.communitymealsCount,u=n.vashonhouseholdCount,m=n.lacomunidadCount,d=n.vyfsCount,h=n.vyfslatinxCount,p=n.vyfsfamilyplaceCount,a.setState({isLoading:!0}),b.a.database().ref().child("buckSets/"+a.props.buckSetName).update({name:a.props.buckSetName,createdOn:new Date,createdBy:a.props.username,expirationDate:a.props.expirationDate,foodbankCount:a.props.foodbankCount,doveCount:a.props.doveCount,communitycareCount:a.props.communitycareCount,seniorcenterCount:a.props.seniorcenterCount,interfaithCount:a.props.interfaithCount,communitymealsCount:a.props.communitymealsCount,vashonhouseholdCount:a.props.vashonhouseholdCount,lacomunidadCount:a.props.lacomunidadCount,vyfsCount:a.props.vyfsCount,vyfslatinxCount:a.props.vyfslatinxCount,vyfsfamilyplaceCount:a.props.vyfsfamilyplaceCount}).then(function(e){console.log("Buckset upload passed"),a.setState({percent:50})}).catch(function(e){console.log("Buckset upload failed with: ",e)}),f=[],v=[a.postVoucherData("foodbank",o,f),a.postVoucherData("dove",r,f),a.postVoucherData("vcc",l,f),a.postVoucherData("seniorcenter",s,f),a.postVoucherData("interfaith",i,f),a.postVoucherData("communitymeals",c,f),a.postVoucherData("vashonhousehold",u,f),a.postVoucherData("lacomunidad",m,f),a.postVoucherData("vyfs",d,f),a.postVoucherData("vyfslatinx",h,f),a.postVoucherData("vyfsfamily",p,f)],g={expirationDate:a.props.expirationDate,ids:f},Promise.all(v).then(function(e){a.toDataURL(J.a,function(e){a.toDataURL(K.a,function(t){var n=a.createPDF(g,t,e);W.a.createPdf(n).download(a.props.buckSetName+".pdf",function(){a.setState({complete:!0,progressLabel:"Complete!",downloadComplete:!0,percent:100,errorMessage:""},function(){setTimeout(function(){a.setState({isLoading:!0})},5e3)})})})})}).catch(function(e){console.log("Error on firebase request",e),a.setState({errorMessage:"Error on firebase request",isLoading:!1})});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,progressLabel:"generating PDF...",downloadComplete:!1,percent:20},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"createPDF",value:function(e,t,a){for(var n=e.ids,o=e.expirationDate,r=(new Date(o),o.split("-")[0]),l={content:[],pageSize:"LETTER"},s=1,i=0;i<n.length;i++){var c=n[i],u=X[c.partnerOrg],m=c.id,d=void 0,h={text:"Expires: "+o,absolutePosition:{x:395,y:i%4*198+141},fontSize:7,color:"white",bold:!0},p={text:r,absolutePosition:{x:391,y:i%4*198+171},fontSize:4,color:"#5f605f",bold:!0},f={image:t,height:198,width:455,absolutePosition:{x:78.5,y:i%4*198}},v={text:u,absolutePosition:{x:386,y:i%4*198+158},fontSize:12,color:"#5f605f",bold:!0};l.content.push(f),l.content.push(h),l.content.push(v),l.content.push(p),s%4===0||s===n.length?(d={qr:m,fit:50,absolutePosition:{x:390,y:i%4*198+44},pageBreak:"after"},l.content.push(d),s%4===0?s===n.length?this.generateSpanishPage(l,a,4,!0):this.generateSpanishPage(l,a,4,!1):s===n.length?this.generateSpanishPage(l,a,s%4,!0):this.generateSpanishPage(l,a,s%4,!1)):(d={qr:m,fit:50,absolutePosition:{x:390,y:i%4*198+44}},l.content.push(d)),s++}return l.pageMargins=[0,0,0,0],l}},{key:"generateSpanishPage",value:function(e,t,a,n){for(var o=0;o<a-1;o++){var r={image:t,height:198,width:455,absolutePosition:{x:78.5,y:o%4*198}};e.content.push(r)}n?e.content.push({image:t,height:198,width:455,absolutePosition:{x:78.5,y:198*(a-1)}}):e.content.push({image:t,height:198,width:455,absolutePosition:{x:78.5,y:198*(a-1)},pageBreak:"after"})}},{key:"postVoucherData",value:function(e,t,a){for(var n={},o=0;o<t;o++){var r={organization:e,createdOn:new Date,expirationDate:this.props.expirationDate,buckSet:this.props.buckSetName},l=b.a.database().ref().child("vouchers").push().key;a.push({partnerOrg:e,id:l}),b.a.database().ref().child("vis2/"+e+"/created/").update(Object($.a)({},l,new Date)),n["/vouchers/"+l]=r}return b.a.database().ref().update(n)}},{key:"render",value:function(){var e=this.props.toggleShowCreateBucks,t=this.state,a=t.progressLabel,n=t.downloadComplete,r=this.props.foodbankCount+this.props.doveCount+this.props.communitycareCount+this.props.seniorcenterCount+this.props.interfaithCount+this.props.communitymealsCount+this.props.vashonhouseholdCount+this.props.lacomunidadCount+this.props.vyfsCount+this.props.vyfslatinxCount+this.props.vyfsfamilyplaceCount;return console.log("loading = ",this.state.isLoading),o.a.createElement(y.a.Column,{width:10},o.a.createElement(R.a,{raised:!0,style:{paddingTop:"30px",paddingRight:"40px",paddingLeft:"40px"}},o.a.createElement(T.a,{as:"h1",textAlign:"left"},"Success!",o.a.createElement(T.a.Subheader,null,'"',this.props.buckSetName,'" Buck Set Created')),o.a.createElement(T.a,{as:"h5",color:"grey",textAlign:"left"},"BUCK ALLOCATION"),o.a.createElement("table",{className:"ui very basic table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,"Vashon Community Food Bank"),o.a.createElement("td",null,this.props.foodbankCount," bucks"),o.a.createElement("td",null,"$",2*this.props.foodbankCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"DoVE"),o.a.createElement("td",null,this.props.doveCount," bucks"),o.a.createElement("td",null,"$",2*this.props.doveCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"Vashon Community Care"),o.a.createElement("td",null,this.props.communitycareCount," bucks"),o.a.createElement("td",null,"$",2*this.props.communitycareCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"Vashon Senior Center"),o.a.createElement("td",null,this.props.seniorcenterCount," bucks"),o.a.createElement("td",null,"$",2*this.props.seniorcenterCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"Interfaith Council to Prevent Homelessness"),o.a.createElement("td",null,this.props.interfaithCount," bucks"),o.a.createElement("td",null,"$",2*this.props.interfaithCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"Community Meals"),o.a.createElement("td",null,this.props.communitymealsCount," bucks"),o.a.createElement("td",null,"$",2*this.props.communitymealsCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"Vashon Household"),o.a.createElement("td",null,this.props.vashonhouseholdCount," bucks"),o.a.createElement("td",null,"$",2*this.props.vashonhouseholdCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"La Communidad \\ ECEAP"),o.a.createElement("td",null,this.props.lacomunidadCount," bucks"),o.a.createElement("td",null,"$",2*this.props.lacomunidadCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"VYFS"),o.a.createElement("td",null,this.props.vyfsCount," bucks"),o.a.createElement("td",null,"$",2*this.props.vyfsCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"VYFS: Latinx"),o.a.createElement("td",null,this.props.vyfslatinxCount," bucks"),o.a.createElement("td",null,"$",2*this.props.vyfslatinxCount,".00")),o.a.createElement("tr",null,o.a.createElement("td",null,"VYFS: Family Place"),o.a.createElement("td",null,this.props.vyfsfamilyplaceCount," bucks"),o.a.createElement("td",null,"$",2*this.props.vyfsfamilyplaceCount,".00")))),o.a.createElement(T.a,{as:"h5",color:"grey",textAlign:"left"},"EXPIRATION DATE"),o.a.createElement("p",null,this.props.expirationDate),o.a.createElement(w.a,{hidden:!0}),o.a.createElement(z.a.Group,{widths:"two"},o.a.createElement(z.a,null,o.a.createElement(z.a.Value,null,1*r),o.a.createElement(z.a.Label,null,"VIGA Bucks")),o.a.createElement(z.a,null,o.a.createElement(z.a.Value,null,"$",2*r,".00"),o.a.createElement(z.a.Label,null,"Dollars"))),o.a.createElement(w.a,{hidden:!0}),this.state.isLoading?o.a.createElement(q.a,{percent:this.state.percent,active:!0,color:"blue",success:n,label:a}):o.a.createElement(S.a.Group,null,o.a.createElement(S.a,{content:"Generate PDF for Print",onClick:this.handleSubmit}),o.a.createElement(S.a.Or,null),o.a.createElement(S.a,{content:"Discard Buck Set",onClick:e}))))}}]),t}(o.a.Component),te=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showCreateBucks:!0,buckSetName:"",foodbankCount:0,doveCount:0,communitycareCount:0,seniorcenterCount:0,interfaithCount:0,communitymealsCount:0,vashonhouseholdCount:0,lacomunidadCount:0,vyfsCount:0,vyfslatinxCount:0,vyfsfamilyplaceCount:0,expirationDate:""},a.handleChange=a.handleChange.bind(Object(A.a)(Object(A.a)(a))),a.toggleShowCreateBucks=a.toggleShowCreateBucks.bind(Object(A.a)(Object(A.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState(e)}},{key:"toggleShowCreateBucks",value:function(e){this.setState({showCreateBucks:!this.state.showCreateBucks})}},{key:"render",value:function(){return o.a.createElement(L.a,null,o.a.createElement(y.a,{stackable:!0,centered:!0},o.a.createElement(y.a.Row,null,this.state.showCreateBucks?o.a.createElement(_,{toggleShowCreateBucks:this.toggleShowCreateBucks,handleChange:this.handleChange,buckSetName:this.state.buckSetName,username:this.props.username,foodbankCount:this.state.foodbankCount,doveCount:this.state.doveCount,communitycareCount:this.state.communitycareCount,seniorcenterCount:this.state.seniorcenterCount,interfaithCount:this.state.interfaithCount,communitymealsCount:this.state.communitymealsCount,vashonhouseholdCount:this.state.vashonhouseholdCount,lacomunidadCount:this.state.lacomunidadCount,vyfsCount:this.state.vyfsCount,vyfslatinxCount:this.state.vyfslatinxCount,vyfsfamilyplaceCount:this.state.vyfsfamilyplaceCount,expirationDate:this.state.expirationDate}):o.a.createElement(ee,{toggleShowCreateBucks:this.toggleShowCreateBucks,buckSetName:this.state.buckSetName,username:this.props.username,foodbankCount:this.state.foodbankCount,doveCount:this.state.doveCount,communitycareCount:this.state.communitycareCount,seniorcenterCount:this.state.seniorcenterCount,interfaithCount:this.state.interfaithCount,communitymealsCount:this.state.communitymealsCount,vashonhouseholdCount:this.state.vashonhouseholdCount,lacomunidadCount:this.state.lacomunidadCount,vyfsCount:this.state.vyfsCount,vyfslatinxCount:this.state.vyfslatinxCount,vyfsfamilyplaceCount:this.state.vyfsfamilyplaceCount,expirationDate:this.state.expirationDate}),o.a.createElement(V,null))))}}]),t}(o.a.Component),ae=a(250),ne=a.n(ae),oe=a(688),re=a(680),le=a(364),se=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleScan=function(e){e&&(console.log("data ",e),a.setState({loading:!0}),a.isValid(e)?b.a.database().ref("vouchers/").child(e).once("value",function(t){t.exists()?(console.log("This ID exists."),a.populateUserData(e),a.populateVisData(e)):a.setState({scanState:"scanError",loading:!1})}).catch(function(e){console.log("Firebase voucher lookup err:",e),a.setState({loading:!1})}):(console.log("bad path"),a.setState({invalidScan:!0,scanState:"scanError",loading:!1})))},a.delayedStopLoading=function(){setTimeout(function(){a.setState({loading:!1})},2e3)},a.populateVisData=function(){var e=Object(U.a)(M.a.mark(function e(t){var n,o;return M.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("In the populate data branch"),n=new Date,o=b.a.database().ref().child("vis1/"+a.props.userId),"farmer"===a.props.role?(o.update(Object($.a)({},t,n)),b.a.database().ref("vouchers/"+t).once("value").then(function(e){var a=e.val().organization;b.a.database().ref().child("vis2/"+a+"/redeemed/").update(Object($.a)({},t,n))})):"caseworker"===a.props.role&&b.a.database().ref("vouchers/"+t).once("value").then(function(e){var a=e.val().organization;b.a.database().ref().child("vis2/"+a+"/handedOut/").update(Object($.a)({},t,n))});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.populateUserData=function(e){var t="",n=b.a.database().ref("vouchers/"+e),o=b.a.database().ref("users/"+a.props.userId);if("farmer"===a.props.role)b.a.database().ref("vouchers/"+e+"/redeemedOn").once("value",function(r){if(r.val())console.log(".val() already exists, setting state to already redeemed"),t="alreadyRedeemed",a.setState({scanState:t},a.delayedStopLoading);else{var l=new Date;n.once("value",function(r){var s=new Date(r.val().expirationDate);l.getTime()<=s.getTime()?(n.update({redeemedOn:l}),o.child("vouchersList").update(Object($.a)({},e,"notPaid")),console.log("in the success statement"),t="success"):(console.log("in the expired statement"),t="expiredFarmer"),a.setState({scanState:t},a.delayedStopLoading)})}});else if("caseworker"===a.props.role){b.a.database().ref("vouchers/"+e+"/handedOutOn").once("value",function(r){if(r.val())t="alreadyHanded",a.setState({scanState:t},a.delayedStopLoading);else{var l=new Date;n.once("value",function(r){var s=new Date(r.val().expirationDate);l.getTime()<=s.getTime()?(n.update({handedOutOn:l}),o.child("vouchersList").update(Object($.a)({},e,"true")),console.log("in the success statement"),t="success"):(console.log("in the expired statement"),t="expiredCaseworker"),a.setState({scanState:t},a.delayedStopLoading)})}})}else a.setState({scanState:"accountIssue"},a.delayedStopLoading)},a.showResponseMessage=function(e){switch(e){case"success":return o.a.createElement(C.a,{positive:!0,attached:"bottom",icon:"thumbs up",header:"Success!",content:"This buck has been submitted! Feel free to recycle or keep for your records."});case"expiredFarmer":return o.a.createElement(C.a,{warning:!0,attached:"bottom",icon:"calendar times outline",header:"Expired",content:"You may still receive compensation, please submit to a FAP organizer in person."});case"alreadyRedeemed":return o.a.createElement(C.a,{negative:!0,attached:"bottom",icon:"x",header:"Previously submitted",content:"This buck has already been submitted."});case"scanError":return o.a.createElement(C.a,{warning:!0,attached:"bottom",icon:"frown",header:"Error scanning",content:"Make sure you have a valid buck, then try again."});case"alreadyHanded":return o.a.createElement(C.a,{negative:!0,attached:"bottom",icon:"x",header:"Previously handed out",content:'This buck has been "handed out" before, no need to scan again.'});case"accountIssue":return o.a.createElement(C.a,{warning:!0,attached:"bottom",icon:"!",header:"Error",content:"Your account does not support scanning."});case"expiredCaseworker":return o.a.createElement(C.a,{warning:!0,attached:"bottom",icon:"calendar times outline",header:"This buck is expired",content:"Please recycle this VIGA farm buck."});default:return o.a.createElement("div",null)}},a.handleError=function(e){console.error(e),a.setState({legacyMode:!0})},a.state={legacyMode:!1,invalidScan:!1,scanState:"",qrCode:"",loading:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(e){return/[^.#$[\]]/.test(e)}},{key:"render",value:function(){var e,t=this.state,a=t.scanState,n=t.loading;return e=this.state.legacyMode?o.a.createElement(ne.a,{delay:3e3,onError:this.handleError,onScan:this.handleScan,legacyMode:!0}):o.a.createElement(ne.a,{delay:3e3,onError:this.handleError,onScan:this.handleScan}),o.a.createElement("div",null,o.a.createElement(E.a,{as:y.a,centered:!0,minWidth:768},o.a.createElement(y.a.Row,null,o.a.createElement(R.a,{basic:!0},n&&o.a.createElement(oe.a,{active:!0,inverted:!0},o.a.createElement(re.a,{size:"medium"})),!n&&this.showResponseMessage(a))),o.a.createElement(y.a.Row,null,o.a.createElement(y.a.Column,{width:6},o.a.createElement(R.a,null,e)),o.a.createElement(y.a.Column,{width:6},o.a.createElement(R.a,{basic:!0},o.a.createElement(T.a,{as:"h2"},"How to Scan"),o.a.createElement("p",null,"1. Make sure to allow this site to use your camera for scanning."),o.a.createElement("p",null,"2. Have your Farm Buck(s) in hand and center QR code in the camera view."),o.a.createElement("p",null,"3. You'll see a message informing you the scan is successful! Keep the buck for your records."))))),o.a.createElement(E.a,{as:L.a,fluid:!0,maxWidth:767},o.a.createElement(le.a,null,o.a.createElement(R.a,{attached:"top"},e),o.a.createElement(R.a,{basic:!0,attached:"bottom"},n&&o.a.createElement(oe.a,{active:!0,inverted:!0},o.a.createElement(re.a,{size:"mini"})),!n&&this.showResponseMessage(a))),o.a.createElement(R.a,{basic:!0},o.a.createElement(T.a,{as:"h2"},"How to Scan"),o.a.createElement("p",null,"1. Make sure to allow this site to use your camera for scanning."),o.a.createElement("p",null,"2. Have your Farm Buck(s) in hand and center QR code in the camera view."),o.a.createElement("p",null,"3. You'll see a message informing you the scan is successful! Keep the buck for your records."))))}}]),t}(o.a.Component),ie=a(251),ce=a.n(ie),ue=a(685),me=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).open=function(){console.log("in open function"),a.setState({open:!0})},a.close=function(){console.log("in close function"),a.setState({open:!1})},a.handleOnUpdate=function(e,t){var n=t.width;return a.setState({width:n})},a.state={role:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handlePurge",value:function(){console.log("in purge function"),ce.a.functions().httpsCallable("deleteUser")({email:this.props.acctSnapshot.val().email}).then(function(e){console.log(e)}),this.props.acctRef.child(this.props.acctSnapshot.key).remove(),this.close()}},{key:"handleApprove",value:function(){var e=this.props.acctSnapshot.val();this.props.acctRef.child(this.props.acctSnapshot.key).update({approved:!0}),ce.a.functions().httpsCallable("changeRole")({email:e.email,role:e.role}).then(function(e){console.log(e)})}},{key:"render",value:function(){var e,t=this,a=this.props.acctSnapshot.val();e=a.approved?o.a.createElement(ue.a.Cell,null,o.a.createElement(O.a,{name:"checkmark"}),"Approved"):o.a.createElement(ue.a.Cell,null,o.a.createElement(O.a,{name:"attention"}),"Requires Approval");var n=this.state.width>=E.a.onlyComputer.minWidth?"center":"left";return o.a.createElement(E.a,{as:ue.a.Row,warning:!a.approved,collapsing:!0,fireOnMount:!0,onUpdate:this.handleOnUpdate},o.a.createElement(ue.a.Cell,null,o.a.createElement(T.a,{as:"h4"},o.a.createElement(T.a.Content,null,a.firstName," ",a.lastName,o.a.createElement(T.a.Subheader,null,a.org)))),o.a.createElement(ue.a.Cell,null,a.role),o.a.createElement(ue.a.Cell,null,a.email),e,o.a.createElement(ue.a.Cell,{textAlign:n},a.approved?null:o.a.createElement(S.a.Group,null,o.a.createElement(S.a,{compact:!0,size:"mini",positive:!0,content:"Approve",onClick:function(){return t.handleApprove()}}),o.a.createElement(S.a,{compact:!0,size:"mini",content:"Reject",onClick:function(){return t.handlePurge()}}))),o.a.createElement(ue.a.Cell,{textAlign:n},o.a.createElement(O.a,{name:"delete",className:"delete",size:"large",onClick:this.open}),o.a.createElement(I.a,{size:"small",header:"Are you sure?",content:"Are you sure you want to delete the account of ".concat(a.firstName," ").concat(a.lastName,"? This action cannot be undone"),cancelButton:"Cancel",confirmButton:"Delete Account",open:this.state.open,onCancel:this.close,onConfirm:function(){return t.handlePurge()}})))}}]),t}(o.a.Component),de=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={accountSnapshot:void 0},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.accountRef.off("value",this.unlisten),this.unlisten=e.accountRef.on("value",function(e){return t.setState({accountSnapshot:e})})}},{key:"componentDidMount",value:function(){var e=this;this.unlisten=this.props.accountRef.on("value",function(t){return e.setState({accountSnapshot:t})})}},{key:"componentWillUnmount",value:function(){this.props.accountRef.off("value",this.unlisten)}},{key:"render",value:function(){var e=this;if(!this.state.accountSnapshot)return o.a.createElement("div",null,o.a.createElement(R.a,null,o.a.createElement(oe.a,{active:!0,inverted:!0},o.a.createElement(re.a,{indeterminate:!0},"Loading Accounts"))));var t=[];return this.state.accountSnapshot.forEach(function(a){e.props.user.email!==a.val().email&&t.push(o.a.createElement(me,{key:a.key,acctSnapshot:a,acctRef:e.props.accountRef}))}),o.a.createElement("div",null,o.a.createElement(E.a,{as:ue.a,selectable:!0,minWidth:768},o.a.createElement(ue.a.Header,null,o.a.createElement(ue.a.Row,{collapsing:!0},o.a.createElement(ue.a.HeaderCell,null,"Name"),o.a.createElement(ue.a.HeaderCell,null,"Role"),o.a.createElement(ue.a.HeaderCell,null,"Email"),o.a.createElement(ue.a.HeaderCell,null,"Approval Status"),o.a.createElement(ue.a.HeaderCell,{textAlign:"center"},"Actions"),o.a.createElement(ue.a.HeaderCell,{textAlign:"center"},"Delete Account"))),o.a.createElement(ue.a.Body,null,t)),o.a.createElement(E.a,{as:ue.a,size:"mini",compact:"small",maxWidth:767},o.a.createElement(ue.a.Header,null,o.a.createElement(ue.a.Row,{collapsing:!0},o.a.createElement(ue.a.HeaderCell,null,"Name"),o.a.createElement(ue.a.HeaderCell,null,"Role"),o.a.createElement(ue.a.HeaderCell,null,"Email"),o.a.createElement(ue.a.HeaderCell,null,"Approval Status"),o.a.createElement(ue.a.HeaderCell,null,"Delete Account"))),o.a.createElement(ue.a.Body,null,t)))}}]),t}(o.a.Component),he=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={value:"",filter:"",name:"",org:"",role:"",date_added:"",errorMessage:void 0},a.handleChange=a.handleChange.bind(Object(A.a)(Object(A.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){e.setState({currentUser:t}),null===e.state.currentUser&&e.props.history.push(f.routes.base)})}},{key:"componentWillUnmount",value:function(){this.authUnsub()}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){var e=b.a.database().ref("/users/");return o.a.createElement(R.a,{raised:!0},o.a.createElement(de,{user:this.state.currentUser,accountRef:e}))}}]),t}(o.a.Component),pe=a(141),fe=a(195),ve=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).listenForUpdates=function(){b.a.database().ref("users").on("child_changed",function(e){a.loadPayoutRecords()})},a.loadPayoutRecords=function(){var e=[];b.a.database().ref("/users/").once("value",function(t){t.forEach(function(t){var a=t.val().role.toLowerCase(),n=t.val().approved.toString().toLowerCase(),o=0,r=0;if(t.val().vouchersList){var l=t.val().vouchersList;Object.keys(l).forEach(function(e){o++,"notpaid"===l[e].toLowerCase()&&r++})}"farmer"===a&&"true"===n&&e.push({name:t.val().firstName+" "+t.val().lastName,farmerUid:t.key,farm:t.val().org,email:t.val().email,totalBucks:o,bucksNotPaid:r,lastPayoutDate:t.val().lastPayoutDate})}),a.setState({farmerList:e})}),console.log("after set state, farmerList: ",e)},a.open=function(){return a.setState({open:!0})},a.close=function(){return a.setState({open:!1})},a.completePayout=function(e){console.log("farmerUid",e),b.a.database().ref("users/"+e+"/vouchersList").on("value",function(t){t.forEach(function(t){var a=t.key;console.log("key",a),b.a.database().ref("users/"+e+"/vouchersList").update(Object($.a)({},a,"paid"))});var a=new Date,n=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear();console.log("prettyDate: ",n),b.a.database().ref("users/"+e).update({lastPayoutDate:n})}),a.close()},a.state={farmerList:[],paidUp:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){e.setState({currentUser:t}),e.state.currentUser||e.props.history.push(f.routes.base)}),this.loadPayoutRecords(),this.listenForUpdates()}},{key:"componentWillUnmount",value:function(){this.authUnsub()}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){var e=this,t=this.state.farmerList;return console.log("farmerList: ",t),o.a.createElement(R.a,{raised:!0},o.a.createElement(T.a,{textAlign:"center",as:"h3"},"Farmer Payout Records"),o.a.createElement(E.a,{as:ue.a,minWidth:1024,singleLine:!0,selectable:!0,stackable:!0},o.a.createElement(ue.a.Header,null,o.a.createElement(ue.a.Row,null,o.a.createElement(ue.a.HeaderCell,null,"Name"),o.a.createElement(ue.a.HeaderCell,null,"Farm"),o.a.createElement(ue.a.HeaderCell,null,"Email"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Total Bucks Collected"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Outstanding Bucks"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Last Payout Date"))),o.a.createElement(ue.a.Body,null,t.map(function(t){return console.log("element: ",t),o.a.createElement(pe.a,null,o.a.createElement(ue.a.Cell,null,t.name),o.a.createElement(ue.a.Cell,null,t.farm),o.a.createElement(ue.a.Cell,null,t.email),o.a.createElement(ue.a.Cell,null,t.totalBucks),o.a.createElement(ue.a.Cell,null,0===t.bucksNotPaid?o.a.createElement(S.a,{compact:!0,basic:!0,color:"green"},o.a.createElement(O.a,{color:"green",name:"checkmark",size:"small"}),"All Paid Up!"):o.a.createElement(S.a,{as:"div",labelPosition:"left"},o.a.createElement(fe.a,{basic:!0,as:"a",pointing:"right"},t.bucksNotPaid," Bucks / $",2*t.bucksNotPaid,".00"),o.a.createElement(S.a,{color:"green",icon:!0,onClick:e.open},o.a.createElement(O.a,{name:"dollar sign"}),"Mark as Paid"),o.a.createElement(I.a,{size:"small",header:"Confirm Payout?",content:"This will mark (".concat(t.bucksNotPaid,") unpaid bucks as PAID for ").concat(t.name," at ").concat(t.farm),cancelButton:"Cancel",confirmButton:"Mark as paid",open:e.state.open,onCancel:e.close,onConfirm:function(){return e.completePayout(t.farmerUid)}}))),o.a.createElement(ue.a.Cell,null,t.lastPayoutDate))}))),o.a.createElement(E.a,{as:ue.a,maxWidth:1023,compact:"very",singleLine:!0,selectable:!0,stackable:!0},o.a.createElement(ue.a.Header,null,o.a.createElement(ue.a.Row,null,o.a.createElement(ue.a.HeaderCell,null,"Name"),o.a.createElement(ue.a.HeaderCell,null,"Email"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Total Bucks Collected"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Outstanding Bucks"),o.a.createElement(ue.a.HeaderCell,{collapsing:!0},"Last Payout Date"))),o.a.createElement(ue.a.Body,null,t.map(function(t){return console.log("element: ",t),o.a.createElement(pe.a,null,o.a.createElement(ue.a.Cell,null,o.a.createElement(T.a,{as:"h4"},o.a.createElement(T.a.Content,null,t.name,o.a.createElement(T.a.Subheader,null,t.farm)))),o.a.createElement(ue.a.Cell,null,t.email),o.a.createElement(ue.a.Cell,null,t.totalBucks),o.a.createElement(ue.a.Cell,null,0===t.bucksNotPaid?o.a.createElement(S.a,{compact:!0,basic:!0,color:"green",size:"mini"},o.a.createElement(O.a,{color:"green",name:"checkmark",size:"small"}),"All Paid Up!"):o.a.createElement(S.a,{as:"div",labelPosition:"left"},o.a.createElement(fe.a,{basic:!0,as:"a",pointing:"right"},t.bucksNotPaid," Bucks / $",2*t.bucksNotPaid,".00"),o.a.createElement(S.a,{color:"green",icon:!0,onClick:e.open},o.a.createElement(O.a,{name:"dollar sign"}),"Mark as Paid"),o.a.createElement(I.a,{size:"small",header:"Confirm Payout?",content:"This will mark (".concat(t.bucksNotPaid,") unpaid bucks as PAID for ").concat(t.name," at ").concat(t.farm),cancelButton:"Cancel",confirmButton:"Mark as paid",open:e.state.open,onCancel:e.close,onConfirm:function(){return e.completePayout(t.farmerUid)}}))),o.a.createElement(ue.a.Cell,null,t.lastPayoutDate))}))))}}]),t}(o.a.Component),ge=a(686),be=a(193),Ee=a(28),ye=a(682),Ce=a(371);function ke(e){var t=Object(n.useState)([]),a=Object(Ee.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(""),i=Object(Ee.a)(s,2),c=i[0],u=i[1],m=Object(n.useState)(!1),d=Object(Ee.a)(m,2),h=(d[0],d[1]);return Object(n.useEffect)(function(){u(e.role),h(e.isLoaded),l(e.charData)},[e]),o.a.createElement(Ce.a,{data:r,colors:{scheme:"nivo"},xScale:{type:"time",format:"%Y-%m-%d",precision:"day"},xFormat:"time: %Y-%m-%d",curve:"monotoneX",yScale:{type:"linear",stacked:!1},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"Dollars",legendOffset:-40,legendPosition:"middle"},axisBottom:{format:"%b %d",tickValues:"every 5 days",legend:"Time Scale",legendOffset:-12},animate:!0,margin:"farmer"===c?{top:10,right:20,bottom:60,left:60}:{top:10,right:90,bottom:60,left:60},enableSlices:"x",lineWidth:3,enableArea:!0,sliceTooltip:function(e){var t=e.slice;return o.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},o.a.createElement("strong",null,"Date:")," ",t.points[0].data.xFormatted,t.points.map(function(e){return o.a.createElement("div",{key:e.id,style:{color:e.serieColor}},o.a.createElement("strong",null,e.serieId,":")," $",e.data.yFormatted,".00")}))},legends:"caseworker"===c?[{anchor:"bottom-right",direction:"column",justify:!1,translateX:90,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}]:void 0})}var Se=a(377);function we(e){var t=Object(n.useState)([]),a=Object(Ee.a)(t,2),r=a[0],l=a[1];return Object(n.useEffect)(function(){l(e.charData)},[e]),o.a.createElement(Se.a,{data:r,keys:Array.isArray(e.curChartKey)?e.curChartKey:[e.curChartKey],indexBy:"organization",theme:{axis:{ticks:{text:{fontSize:"18px"}},legend:{text:{fontSize:"18px"}}},legends:{text:{fontSize:"18px"}}},margin:{top:50,right:150,bottom:200,left:80},padding:.2,groupMode:"grouped",colors:["#ABDDA4","#66C2A5","#3288BD"],animate:!0,motionStiffness:90,motionDamping:15,borderColor:{from:"color",modifiers:[["darker",1.6]]},axisTop:null,axisRight:null,axisBottom:{tickSize:5,tickPadding:5,tickRotation:45,legend:"Organization",legendPosition:"middle",legendOffset:100},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:"Dollars",legendPosition:"middle",legendOffset:-55},tooltip:function(e){var t=e.data,a=e.indexValue;return o.a.createElement("div",{style:{overflow:"auto"}},a.toUpperCase(),o.a.createElement("div",null,"Created:",o.a.createElement("div",{style:{marginLeft:"5px",float:"right"}},"$",t.created,".00")),o.a.createElement("div",null,"Distributed:",o.a.createElement("div",{style:{marginLeft:"5px",float:"right"}},"$",t.handedOut,".00")),o.a.createElement("div",null,"Redeemed:",o.a.createElement("div",{style:{marginLeft:"5px",float:"right"}},"$",t.redeemed,".00")))},legends:[{dataFrom:"keys",anchor:"bottom-right",direction:"column",justify:!1,translateX:120,translateY:0,itemsSpacing:2,itemWidth:100,itemHeight:20,itemDirection:"left-to-right",itemOpacity:.85,symbolSize:15,effects:[{on:"hover",style:{itemOpacity:1}}]}],labelSkipWidth:12,labelSkipHeight:12,labelTextColor:{from:"color",modifiers:[["darker",1.6]]}})}var Oe=[{key:"all",text:"All Organizations",value:"all"},{key:"f",text:"Vashon Community Food Bank",value:"foodbank"},{key:"d",text:"The Dove Project",value:"dove"},{key:"c",text:"Vashon Community Care",value:"vcc"},{key:"s",text:"Vashon Senior Center",value:"seniorcenter"},{key:"i",text:"Interfaith Council to Prevent Homelessness",value:"interfaith"},{key:"m",text:"Community Meals",value:"communitymeals"},{key:"h",text:"Vashon Household",value:"vashonhousehold"},{key:"l",text:"La Comunidad & ECEAP",value:"lacomunidad"},{key:"y",text:"VYFS",value:"vyfs"},{key:"x",text:"VYFS: Latinx",value:"vyfslatinx"},{key:"p",text:"VYFS: Family Place",value:"vyfsfamily"}],xe=[{key:"allbucks",text:"All Bucks",value:["created","handedOut","redeemed"]},{key:"created",text:"Bucks Created",value:"created"},{key:"redeemed",text:"Bucks Redeemed",value:"redeemed"},{key:"handedOut",text:"Bucks Handed Out",value:"handedOut"}],je=[{text:"All Time",value:"all"},{text:"This Year",value:"year"},{text:"This Month",value:"month"}],De={all:"All Time",year:"This Year",month:"This Month"};function Ae(e){var t,a=Object(n.useState)([]),r=Object(Ee.a)(a,2),l=r[0],s=r[1],i=Object(n.useState)(Oe[0].value),c=Object(Ee.a)(i,2),u=c[0],m=c[1],d=Object(n.useState)(xe[0].value),h=Object(Ee.a)(d,2),p=h[0],f=h[1],v=Object(n.useState)(je[0].value),g=Object(Ee.a)(v,2),E=g[0],C=g[1],k=Object(n.useState)(""),S=Object(Ee.a)(k,2),w=S[0],O=S[1],x=Object(n.useState)(!1),j=Object(Ee.a)(x,2),D=j[0],A=j[1],B=Object(n.useState)(0),P=Object(Ee.a)(B,2),I=P[0],N=P[1],V=Object(n.useState)(""),F=Object(Ee.a)(V,2),M=(F[0],F[1],Object(n.useState)(0)),U=Object(Ee.a)(M,2),H=U[0],W=U[1],Z=Object(n.useState)(0),Y=Object(Ee.a)(Z,2),_=Y[0],q=Y[1],G=Object(n.useState)(),K=Object(Ee.a)(G,2);K[0],K[1];function Q(){b.a.database().ref().child("vis2/").on("value",function(e){var t=[],a=0,n=0,o=0;for(var r in e.val()){var l={created:0,handedOut:0,redeemed:0};l.organization=r;var i=e.val();for(var c in i[r]){var u=0;for(var m in i[r][c])E===je[0].value?("redeemed"===c?a+=2:"created"===c?o+=2:n+=2,u+=2):E===je[1].value?new Date(i[r][c][m]).getFullYear()===(new Date).getFullYear()&&("redeemed"===c?a+=2:"created"===c?o+=2:n+=2,u+=2):new Date(i[r][c][m]).getMonth()===(new Date).getMonth()&&("redeemed"===c?a+=2:"created"===c?o+=2:n+=2,u+=2);l[c]=u}t.push(l)}s(t),q(o),W(n),N(a)})}function J(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}return Object(n.useEffect)(function(){O(e.role),"farmer"===e.role?function(){var t=b.a.database().ref("vis1/"+e.uid).orderByValue(),a=[];t.on("child_added",function(e){var t=e.val(),n=new Date(t).toISOString().split("T")[0],o=a.findIndex(function(e,t){return e.x===n});0===a.length?(a.push({x:new Date(new Date(n)-1).toISOString().split("T")[0],y:0}),a.push({x:n,y:2})):0!==a.length&&-1===o?a.push({x:n,y:a[a.length-1].y+2}):a[o].y+=2,a.length>3&&A(!0),s([{id:"Redeemed",data:a}]),N(a[a.length-1].y)})}():"admin"===e.role?Q():"caseworker"===e.role&&b.a.database().ref().child("vis2/"+e.org).orderByValue().on("value",function(e){var t=[];for(var a in e.val())if("created"!==a){var n=[],o=e.val(),r=[],l=["2019-05-04T07:00:00.000Z","2019-05-05T07:00:00.000Z","2019-05-06T07:00:00.000Z","2019-05-07T07:00:00.000Z","2019-05-08T07:00:00.000Z","2019-05-09T07:00:00.000Z","2019-05-10T07:00:00.000Z","2019-05-11T07:00:00.000Z","2019-05-12T07:00:00.000Z","2019-05-13T07:00:00.000Z","2019-05-14T07:00:00.000Z","2019-05-15T07:00:00.000Z","2019-05-16T07:00:00.000Z","2019-05-17T07:00:00.000Z","2019-05-18T07:00:00.000Z","2019-05-19T07:00:00.000Z","2019-05-20T07:00:00.000Z","2019-05-21T07:00:00.000Z","2019-05-22T07:00:00.000Z","2019-05-23T07:00:00.000Z","2019-05-24T07:00:00.000Z","2019-05-25T07:00:00.000Z","2019-05-26T07:00:00.000Z","2019-05-27T07:00:00.000Z","2019-05-28T07:00:00.000Z","2019-05-29T07:00:00.000Z","2019-05-30T07:00:00.000Z","2019-06-01T07:00:00.000Z","2019-06-02T07:00:00.000Z","2019-06-03T07:00:00.000Z","2019-06-04T07:00:00.000Z"];for(var i in o[a]){console.log(o[a][i]);try{r.push(new Date(o[a][i]).toISOString().split("T")[0])}catch(v){console.log(v)}}for(var c={},u=0;u<r.length;u++){var m=r[u];c[m]=c[m]?c[m]+1:1}var d=0;for(var h in l){var p=new Date(l[h]).toISOString().split("T")[0];c[p]&&(d+=2*c[p]),n.push({x:p,y:d})}var f={id:a,data:n};"redeemed"===a?N(n[n.length-1].y):"handedOut"===a&&W(n[n.length-1].y),t=[].concat(Object(be.a)(t),[f])}(function(e){for(var t=0,a=e.length;t<a;t++)if(e[t].data.length<5)return!1;return!0})(t)&&A(!0),s(t)})},[e]),Object(n.useEffect)(function(){"admin"===w&&Q()},[E]),console.log("curChartKey",p),console.log("keySelection[0].value",xe[0].value),"admin"===w?p===xe[0].value?(console.log("all"+p),t=l.filter(function(e){return e.organization===u||u===Oe[0].value}).map(function(e){var t;return t={organization:e.organization},Object($.a)(t,p[0],e[p[0]]),Object($.a)(t,p[1],e[p[1]]),Object($.a)(t,p[2],e[p[2]]),t})):t=l.filter(function(e){return e.organization===u||u===Oe[0].value}).map(function(e){return Object($.a)({organization:e.organization},p,e[p])}):t=l,o.a.createElement(L.a,{fluid:!0},o.a.createElement(y.a,{stackable:!0,centered:!0},o.a.createElement(y.a.Row,null,o.a.createElement(y.a.Column,{width:11},o.a.createElement(R.a,{className:"graph_container",raised:!0,style:{height:"700px"}},o.a.createElement(T.a,{className:"graph_title",size:"huge"},"VIGA Farm Buck Data - ",De[E]," "),"admin"===w?o.a.createElement(we,{curChartKey:p,charData:t}):o.a.createElement(ke,{charData:t,role:w,isLoaded:D}))),o.a.createElement(y.a.Column,{width:4},"admin"===w?o.a.createElement("div",null,o.a.createElement(R.a,{raised:!0,padded:!0},o.a.createElement(T.a,{as:"h2"},"Totals"),o.a.createElement(z.a.Group,{size:"small",horizontal:!0},o.a.createElement(z.a,null,o.a.createElement(z.a.Value,null,"$"+J(_)+".00"),o.a.createElement(z.a.Label,null,"Dollars Created")),o.a.createElement(z.a,null,o.a.createElement(z.a.Value,null,"$"+J(H)+".00"),o.a.createElement(z.a.Label,null,"Dollars Handed Out")),o.a.createElement(z.a,null,o.a.createElement(z.a.Value,null,"$"+J(I)+".00"),o.a.createElement(z.a.Label,null,"Dollars Redeemed")))),o.a.createElement(R.a,{raised:!0,centered:!0},o.a.createElement(T.a,{as:"h4",content:"Filter by Time Interval"}),o.a.createElement(ye.a,{defaultValue:je[0].value,fluid:!0,selection:!0,options:je,onChange:function(e,t){C(t.value)}}),o.a.createElement(T.a,{as:"h4",content:"Filter by Organization"}),o.a.createElement(ye.a,{defaultValue:Oe[0].value,fluid:!0,selection:!0,options:Oe,onChange:function(e,t){m(t.value)}}),o.a.createElement(T.a,{as:"h4",content:"Filter by Buck State"}),o.a.createElement(ye.a,{defaultValue:xe[0].value,fluid:!0,selection:!0,options:xe,onChange:function(e,t){f(t.value)}}))):null))))}var Be=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOnUpdate=function(e,t){var n=t.width;return a.setState({width:n})},a.handleSignOut=function(){b.a.auth().signOut().then(a.props.history.push(f.routes.base))},a.state={role:"",username:"",org:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"onSetSidebarOpen",value:function(e){}},{key:"mediaQueryChanged",value:function(){}},{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onAuthStateChanged(function(t){t?b.a.database().ref("users/"+t.uid).once("value").then(function(a){var n=a.val().org;t.getIdTokenResult(!0).then(function(a){console.log(a.claims.role),"caseworker"===a.claims.role?e.setState({username:t.email,uid:t.uid,role:a.claims.role,org:n}):e.setState({username:t.email,uid:t.uid,role:a.claims.role})})}):e.props.history.push(f.routes.base)})}},{key:"render",value:function(){var e,t,a,n,r,l=this,s=[o.a.createElement(ge.a.Item,{name:"Scan",as:v.a,to:f.routes.dash.base,active:this.props.location.pathname===f.routes.dash.base}),o.a.createElement(ge.a.Item,{name:"View Data",as:v.a,to:f.routes.dash.viewData,active:this.props.location.pathname===f.routes.dash.viewData})],i=[o.a.createElement(ge.a.Item,{name:"Scan",as:v.a,to:f.routes.dash.base,active:this.props.location.pathname===f.routes.dash.base}),o.a.createElement(ge.a.Item,{name:"View Data",as:v.a,to:f.routes.dash.viewData,active:this.props.location.pathname===f.routes.dash.viewData})],c=[o.a.createElement(ge.a.Item,{name:"Create Bucks",as:v.a,to:f.routes.dash.bucksLanding,active:this.props.location.pathname===f.routes.dash.bucksLanding}),o.a.createElement(ge.a.Item,{name:"Manage Accounts",as:v.a,to:f.routes.dash.manageAccount,active:this.props.location.pathname===f.routes.dash.manageAccount}),o.a.createElement(ge.a.Item,{name:"View Data",as:v.a,to:f.routes.dash.viewData,active:this.props.location.pathname===f.routes.dash.viewData})],u=[o.a.createElement(ge.a.Item,{name:"Farmer Payout",as:v.a,to:f.routes.dash.farmerPayout,active:this.props.location.pathname===f.routes.dash.farmerPayout})],m=[o.a.createElement(p.a,{exact:!0,path:f.routes.dash.base,render:function(){return o.a.createElement(se,{role:l.state.role,userId:l.state.uid})}}),o.a.createElement(p.a,{path:f.routes.dash.viewData,render:function(){return o.a.createElement(Ae,{role:l.state.role,uid:l.state.uid,org:l.state.org})}})],g=[o.a.createElement(p.a,{exact:!0,path:f.routes.dash.base,render:function(){return o.a.createElement(se,{role:l.state.role,userId:l.state.uid})}}),o.a.createElement(p.a,{path:f.routes.dash.viewData,render:function(){return o.a.createElement(Ae,{role:l.state.role,uid:l.state.uid,org:l.state.org})}})],b=[o.a.createElement(p.a,{path:f.routes.dash.bucksLanding,render:function(){return o.a.createElement(te,{username:l.state.username})}}),o.a.createElement(p.a,{path:f.routes.dash.manageAccount,component:he}),o.a.createElement(p.a,{path:f.routes.dash.base,render:function(){return o.a.createElement(Ae,{role:l.state.role,uid:l.state.uid,org:l.state.org})}}),o.a.createElement(p.a,{path:f.routes.dash.createBucks,render:function(){return o.a.createElement(_,{username:l.state.username})}})],y=[o.a.createElement(p.a,{path:f.routes.dash.farmerPayout,render:function(){return o.a.createElement(ve,{username:l.state.username})}})];return"admin"===this.state.role?(e=b,a=c,t="Food Access Partnership",n=!0):"caseworker"===this.state.role?(e=g,a=i,t="Partner Organization",n=!1):"farmer"===this.state.role?(e=m,a=s,t="Farmer",n=!1):"bookkeeper"===this.state.role&&(e=y,a=u,t="Bookkeeper",n=!1),"/dash"===this.props.location.pathname?r="View Data":"/dash/manage"===this.props.location.pathname?r="Manage Accounts":"/dash/BucksLanding"===this.props.location.pathname?r="Create a Buck Set":"/dash/farmerPayout"===this.props.location.pathname?r="Farmer Payout":"/dash/ViewData"===this.props.location.pathname&&(r="View Data"),o.a.createElement("div",null,o.a.createElement(E.a,{as:R.a,clearing:!0,minWidth:768,basic:!0,color:"blue",inverted:!0,padded:"very",className:"HeaderContainer"},o.a.createElement(T.a,{padded:"very",size:"huge",floated:"left",inverted:!0,color:"white"},r),o.a.createElement(T.a,{floated:"right",inverted:!0,color:"white",className:"Header_UserInfo"},this.state.username,o.a.createElement(T.a.Subheader,{inverted:!0,color:"white"},o.a.createElement(fe.a,null,o.a.createElement(O.a,{name:"user"})," ",t)))),o.a.createElement(E.a,{as:R.a,maxWidth:767,basic:!0,color:"blue",inverted:!0,padded:"very",className:"HeaderContainer"},o.a.createElement(T.a,{padded:"very",size:"huge",inverted:!0,color:"white"},r,o.a.createElement(T.a.Subheader,{inverted:!0,color:"white",className:"Header_UserInfo mobile"},this.state.username,o.a.createElement(fe.a,null,o.a.createElement(O.a,{name:"user"})," ",t)))),o.a.createElement(ge.a,{secondary:!0,stackable:n,className:"NavMenuContainer"},a,o.a.createElement(ge.a.Menu,{position:"right"},o.a.createElement(ge.a.Item,{className:"Logout_btn",name:"logout",onClick:this.handleSignOut}))),"/dash/ViewData"!==this.props.location.pathname&&o.a.createElement(L.a,null,o.a.createElement(d.a,null,o.a.createElement(h.a,null,e))),"/dash/ViewData"===this.props.location.pathname&&o.a.createElement(d.a,null,o.a.createElement(h.a,null,e)))}}]),t}(o.a.Component),Pe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authUnsub=b.a.auth().onIdTokenChanged(function(t){t?(console.log("user = ",{user:t}),t.getIdTokenResult(!0).then(function(t){console.log("idTokenResult",t.claims.role),t.claims.role&&e.props.history.push(f.routes.dash.base)})):console.log("user not defined")})}},{key:"render",value:function(){return o.a.createElement(y.a,{centered:"true"},o.a.createElement(y.a.Column,{width:8,verticalAlign:"middle",textAlign:"center"},o.a.createElement(R.a,{inverted:!0,color:"olive",className:"barrierContainer"},o.a.createElement(O.a,{name:"hand paper outline",size:"huge"}),o.a.createElement(T.a,{inverted:!0,as:"h1",content:"Your account is pending approval."}),o.a.createElement(T.a.Subheader,null,"Once your account is approved this page will automatically update."),o.a.createElement("p",null,"Please contact foodaccesspartnership@vigavashon.org with account inquiries."))))}}]),t}(o.a.Component),Ie=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(d.a,null,o.a.createElement(h.a,null,o.a.createElement(p.a,{exact:!0,path:f.routes.base,component:x}),o.a.createElement(p.a,{path:f.routes.dash.base,component:Be}),o.a.createElement(p.a,{path:f.routes.createAccount,component:j}),o.a.createElement(p.a,{path:f.routes.accountRecovery,component:D}),o.a.createElement(p.a,{path:f.routes.barrier,component:Pe}))))}}]),t}(n.Component),Ne=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Le(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(661);b.a.initializeApp({apiKey:"AIzaSyArFZbAeQ5YDelr8x-lChKbUvPvo2Z7GF8",authDomain:"fapadmin-97af8.firebaseapp.com",databaseURL:"https://fapadmin-97af8.firebaseio.com",projectId:"fapadmin-97af8",storageBucket:"fapadmin-97af8.appspot.com",messagingSenderId:"766068690399"}),l.a.render(o.a.createElement(Ie,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/food-access-vashon",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/food-access-vashon","/service-worker.js");Ne?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Le(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Le(t,e)})}}()}},[[392,1,2]]]);
//# sourceMappingURL=main.589225de.chunk.js.map